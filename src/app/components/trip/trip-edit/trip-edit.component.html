<section id="breadcrumbs" class="breadcrumbs">
  <div class="breadcrumb-hero">
    <div class="container">
      <div class="breadcrumb-hero">
        <h2>{{'trip.editTrip' | translate}}</h2>
      </div>
    </div>
  </div>
  <div class="container">
    <ol>
      <li><a href="/">{{'header.home' | translate}}</a></li>
      <li><a href="/trips">{{'trips.trips' | translate}}</a></li>
      <li>{{'trip.editTrip' | translate}}</li>
    </ol>
  </div>
</section>

<section id="service-login" class="services section-bg">
  <div class="container">

    <div class="row justify-content-center align-items-center">
      <div class="col-md-6 col-md-offset-3">
        <div class="mx-auto">

          <form [formGroup]="tripForm" (ngSubmit)="onSubmit()">
            <fieldset>

              <input class="form-control" formControlName="_id" type="hidden">
              <input class="form-control" formControlName="ticker" type="hidden">
              <input class="form-control" formControlName="price" type="hidden">
              <input class="form-control" formControlName="published" type="hidden">

              <div class="form-group has-danger">
                <label for="title" class="form-control-label">{{'trip.title' | translate}}</label>
                <input id="title" type="text" formControlName="title" class="form-control">
              </div>

              <div class="form-group has-danger">
                <label for="description" class="form-control-label">{{'trip.description' | translate}}
                  <textarea id="description" rows="4" cols="58" name="description" formControlName="description"
                    class="form-control">
                  </textarea>
                </label>
              </div>


              <div class="form-group has-danger">
                <label for="pickerStartDate" class="form-control-label">{{'trip.startDate' | translate}}</label>
                <div>
                  <input matInput [matDatepicker]="pickerStartDate" placeholder="Fecha de comienzo" autocomplete="off"
                    name="startDate" formControlName="startDate" class="form-control">
                  <mat-datepicker-toggle matSuffix [for]="pickerStartDate"></mat-datepicker-toggle>
                  <mat-datepicker [startAt]="startDate" #pickerStartDate></mat-datepicker>
                </div>
              </div>

              <div class="form-group has-danger">
                <label for="pickerEndDate" class="form-control-label">{{'trip.endDate' | translate}}</label>
                <div>
                  <input matInput [matDatepicker]="pickerEndDate" placeholder="Fecha de fin" autocomplete="off"
                    name="endDate" formControlName="endDate" class="form-control">
                  <mat-datepicker-toggle matSuffix [for]="pickerEndDate"></mat-datepicker-toggle>
                  <mat-datepicker [startAt]="endDate" #pickerEndDate></mat-datepicker>
                </div>
              </div>

              <div formArrayName="requirements">
                <h4>{{'trip.requirements' | translate}}</h4>
                <div *ngFor="let req of requirements.controls; let i=index">
                  <label>
                    {{'trip.requirement' | translate}}:
                    <div class="input-group mb-3">
                      <div class="input-group-prepend">
                        <button type='button' class="btn btn-danger"
                          (click)="removeRequirement(i)">{{'trip.removeRequirement' | translate}}</button>
                      </div>
                      <input type="text" [formControlName]="i" class="form-control">
                    </div>
                  </label>
                </div>
                <button type='button' class="btn btn-info"
                  (click)="addRequirement()">{{'trip.addRequirement' | translate}}</button>
              </div>

              <br />

              <div formArrayName="stages">
                <h4>{{'trip.stages' | translate}}</h4>
                <div *ngFor="let st of stages.controls; let k = index">
                  <label>
                    <div class="row">
                      <div class="col" style="padding-left: 7px;">
                        <h5>Etapa {{k+1}}</h5>
                      </div>
                      <div class="col-auto">
                        <button type='button' class="btn btn-danger ,ml-auto"
                          (click)="removeStage(k)">{{'trip.removeStage' | translate}}</button>
                      </div>
                      <div [formGroupName]="k">
                        <div class="form-group">
                          <label>{{'stage.title' | translate}}</label>
                          <input type="text" formControlName="title" class="form-control">
                        </div>

                        <div class="form-group">
                          <label>{{'stage.description' | translate}}</label>
                          <textarea rows="4" cols="58" formControlName="description" class="form-control">
                        </textarea>
                        </div>

                        <div class="form-group">
                          <label>{{'stage.price' | translate}}</label>
                          <input type="number" formControlName="price" class="form-control">
                        </div>
                      </div>
                    </div>
                  </label>
                </div>
                <button type='button' class="btn btn-info"
                  (click)="addStage()">{{'trip.addStage' | translate}}</button>
              </div>

              <button type="submit" class="btn btn-primary" [disabled]="tripForm.invalid">
                {{'form.save' | translate}}
              </button>

              <button (click)="goBack()" class="bn btn-primary">
                {{'form.cancel' | translate}}
              </button>

            </fieldset>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>